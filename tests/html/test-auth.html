<!DOCTYPE html>
<html>
<head>
    <title>Test Firebase Auth</title>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-auth-compat.js"></script>
</head>
<body>
    <h1>Firebase Auth Test</h1>
    <div id="status">Checking auth status...</div>
    <button id="checkBtn" onclick="checkAuth()">Check Auth Status</button>
    <pre id="output"></pre>

    <script>
        // Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyApTHhm_Ia0sz63YDw2mYXiXp_qED7NdOQ",
            authDomain: "pyebwa-f5960.firebaseapp.com",
            projectId: "pyebwa-f5960",
            storageBucket: "pyebwa-f5960.firebasestorage.app",
            messagingSenderId: "1042887343749",
            appId: "1:1042887343749:web:c276bf69b6c0895111f3ec",
            measurementId: "G-ZX92K1TMM3"
        };

        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();

        // Set persistence
        auth.setPersistence(firebase.auth.Auth.Persistence.LOCAL);

        // Check auth state
        auth.onAuthStateChanged((user) => {
            const status = document.getElementById('status');
            const output = document.getElementById('output');
            
            if (user) {
                status.innerHTML = '<span style="color: green;">✓ Authenticated</span>';
                output.textContent = JSON.stringify({
                    uid: user.uid,
                    email: user.email,
                    displayName: user.displayName,
                    emailVerified: user.emailVerified
                }, null, 2);
            } else {
                status.innerHTML = '<span style="color: red;">✗ Not authenticated</span>';
                output.textContent = 'No user logged in';
            }
        });

        function checkAuth() {
            const output = document.getElementById('output');
            const user = auth.currentUser;
            
            output.textContent = 'Current user: ' + (user ? JSON.stringify({
                uid: user.uid,
                email: user.email,
                displayName: user.displayName
            }, null, 2) : 'null');
            
            // Also check localStorage and sessionStorage
            output.textContent += '\n\nLocalStorage:\n';
            for (let i = 0; i < localStorage.length; i++) {
                const key = localStorage.key(i);
                if (key.includes('firebase') || key.includes('pyebwa')) {
                    output.textContent += key + ': ' + localStorage.getItem(key).substring(0, 50) + '...\n';
                }
            }
        }
    </script>
</body>
</html>