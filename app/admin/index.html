<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pyebwa Admin Dashboard</title>
    <link rel="icon" type="image/x-icon" href="/favicon.ico">
    
    <!-- CSS -->
    <link rel="stylesheet" href="/app/admin/css/admin-base.css?v=1">
    <link rel="stylesheet" href="/app/admin/css/admin-components.css?v=1">
    <link rel="stylesheet" href="/app/admin/css/admin-dark.css?v=1">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    
    <!-- Chart.js for analytics -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.js"></script>
    
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-storage-compat.js"></script>
</head>
<body class="admin-body">
    <!-- Loading Screen -->
    <div id="adminLoader" class="admin-loader">
        <div class="loader-content">
            <div class="spinner"></div>
            <p>Verifying admin access...</p>
        </div>
    </div>

    <!-- Main Admin Container -->
    <div id="adminApp" class="admin-app" style="display: none;">
        <!-- Top Navigation -->
        <nav class="admin-nav">
            <div class="nav-left">
                <button class="nav-toggle" id="navToggle">
                    <span class="material-icons">menu</span>
                </button>
                <div class="nav-brand">
                    <img src="/app/images/pyebwa-logo.png" alt="Pyebwa" class="nav-logo">
                    <span class="nav-title">Admin Dashboard</span>
                </div>
            </div>
            <div class="nav-right">
                <button class="nav-btn theme-toggle" id="themeToggle" title="Toggle theme">
                    <span class="material-icons">dark_mode</span>
                </button>
                <button class="nav-btn notifications" id="notificationsBtn" title="Notifications">
                    <span class="material-icons">notifications</span>
                    <span class="notification-badge" style="display: none;">0</span>
                </button>
                <div class="nav-user">
                    <img src="/app/images/default-avatar.png" alt="Admin" class="user-avatar" id="adminAvatar">
                    <div class="user-info">
                        <span class="user-name" id="adminName">Admin</span>
                        <span class="user-role" id="adminRole">Super Admin</span>
                    </div>
                    <button class="nav-btn user-menu-toggle">
                        <span class="material-icons">arrow_drop_down</span>
                    </button>
                    <div class="user-dropdown">
                        <a href="/app/" class="dropdown-item">
                            <span class="material-icons">home</span>
                            <span>Back to App</span>
                        </a>
                        <a href="#profile" class="dropdown-item">
                            <span class="material-icons">person</span>
                            <span>My Profile</span>
                        </a>
                        <a href="#settings" class="dropdown-item">
                            <span class="material-icons">settings</span>
                            <span>Settings</span>
                        </a>
                        <hr>
                        <a href="#" class="dropdown-item" id="adminLogout">
                            <span class="material-icons">logout</span>
                            <span>Logout</span>
                        </a>
                    </div>
                </div>
            </div>
        </nav>

        <!-- Main Container -->
        <div class="admin-container">
            <!-- Sidebar -->
            <aside class="admin-sidebar" id="adminSidebar">
                <div class="sidebar-content">
                    <ul class="sidebar-menu">
                        <li class="menu-item active">
                            <a href="#dashboard" class="menu-link">
                                <span class="material-icons">dashboard</span>
                                <span class="menu-text">Dashboard</span>
                            </a>
                        </li>
                        <li class="menu-item">
                            <a href="#users" class="menu-link">
                                <span class="material-icons">people</span>
                                <span class="menu-text">Users</span>
                                <span class="menu-badge" id="userCount">0</span>
                            </a>
                        </li>
                        <li class="menu-item">
                            <a href="#trees" class="menu-link">
                                <span class="material-icons">account_tree</span>
                                <span class="menu-text">Family Trees</span>
                            </a>
                        </li>
                        <li class="menu-item">
                            <a href="#content" class="menu-link">
                                <span class="material-icons">photo_library</span>
                                <span class="menu-text">Content</span>
                            </a>
                        </li>
                        <li class="menu-item">
                            <a href="#analytics" class="menu-link">
                                <span class="material-icons">analytics</span>
                                <span class="menu-text">Analytics</span>
                            </a>
                        </li>
                        <li class="menu-item">
                            <a href="#communications" class="menu-link">
                                <span class="material-icons">campaign</span>
                                <span class="menu-text">Communications</span>
                            </a>
                        </li>
                        <li class="menu-section">System</li>
                        <li class="menu-item">
                            <a href="#settings" class="menu-link">
                                <span class="material-icons">settings</span>
                                <span class="menu-text">Settings</span>
                            </a>
                        </li>
                        <li class="menu-item">
                            <a href="#audit" class="menu-link">
                                <span class="material-icons">history</span>
                                <span class="menu-text">Audit Logs</span>
                            </a>
                        </li>
                        <li class="menu-item">
                            <a href="#backup" class="menu-link">
                                <span class="material-icons">backup</span>
                                <span class="menu-text">Backup</span>
                            </a>
                        </li>
                    </ul>
                </div>
            </aside>

            <!-- Main Content Area -->
            <main class="admin-main">
                <!-- Dashboard View -->
                <div id="dashboardView" class="admin-view active">
                    <div class="view-header">
                        <h1>Dashboard</h1>
                        <div class="header-actions">
                            <button class="btn btn-secondary" id="refreshDashboard">
                                <span class="material-icons">refresh</span>
                                <span>Refresh</span>
                            </button>
                            <button class="btn btn-primary" id="exportReport">
                                <span class="material-icons">download</span>
                                <span>Export Report</span>
                            </button>
                        </div>
                    </div>

                    <!-- Stats Overview -->
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-icon users">
                                <span class="material-icons">people</span>
                            </div>
                            <div class="stat-content">
                                <h3 class="stat-value" id="totalUsers">0</h3>
                                <p class="stat-label">Total Users</p>
                                <span class="stat-change positive">+0%</span>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon trees">
                                <span class="material-icons">account_tree</span>
                            </div>
                            <div class="stat-content">
                                <h3 class="stat-value" id="totalTrees">0</h3>
                                <p class="stat-label">Family Trees</p>
                                <span class="stat-change positive">+0%</span>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon active">
                                <span class="material-icons">trending_up</span>
                            </div>
                            <div class="stat-content">
                                <h3 class="stat-value" id="activeUsers">0</h3>
                                <p class="stat-label">Active Today</p>
                                <span class="stat-change">0%</span>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon storage">
                                <span class="material-icons">storage</span>
                            </div>
                            <div class="stat-content">
                                <h3 class="stat-value" id="storageUsed">0 GB</h3>
                                <p class="stat-label">Storage Used</p>
                                <span class="stat-change negative">+0%</span>
                            </div>
                        </div>
                    </div>

                    <!-- Charts Row -->
                    <div class="charts-row">
                        <div class="chart-container">
                            <div class="chart-header">
                                <h3>User Growth</h3>
                                <select class="chart-period" id="growthPeriod">
                                    <option value="7">Last 7 days</option>
                                    <option value="30" selected>Last 30 days</option>
                                    <option value="90">Last 90 days</option>
                                    <option value="365">Last year</option>
                                </select>
                            </div>
                            <canvas id="userGrowthChart"></canvas>
                        </div>
                        <div class="chart-container">
                            <div class="chart-header">
                                <h3>Activity Overview</h3>
                            </div>
                            <canvas id="activityChart"></canvas>
                        </div>
                    </div>

                    <!-- Recent Activity -->
                    <div class="activity-section">
                        <h3>Recent Activity</h3>
                        <div class="activity-list" id="recentActivity">
                            <div class="activity-item">
                                <div class="activity-icon">
                                    <span class="material-icons">person_add</span>
                                </div>
                                <div class="activity-content">
                                    <p>Loading recent activity...</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Users View -->
                <div id="usersView" class="admin-view" style="display: none;">
                    <div class="view-header">
                        <h1>User Management</h1>
                        <div class="header-actions">
                            <button class="btn btn-secondary" id="exportUsers">
                                <span class="material-icons">download</span>
                                <span>Export</span>
                            </button>
                            <button class="btn btn-primary" id="inviteUser">
                                <span class="material-icons">person_add</span>
                                <span>Invite User</span>
                            </button>
                        </div>
                    </div>

                    <!-- Filters -->
                    <div class="filters-section">
                        <div class="search-box">
                            <span class="material-icons">search</span>
                            <input type="text" id="userSearch" placeholder="Search users...">
                        </div>
                        <div class="filter-group">
                            <select id="userStatusFilter">
                                <option value="">All Status</option>
                                <option value="active">Active</option>
                                <option value="inactive">Inactive</option>
                                <option value="suspended">Suspended</option>
                            </select>
                            <select id="userRoleFilter">
                                <option value="">All Roles</option>
                                <option value="user">User</option>
                                <option value="admin">Admin</option>
                                <option value="superadmin">Super Admin</option>
                            </select>
                            <input type="date" id="userDateFilter" placeholder="Joined after...">
                        </div>
                    </div>

                    <!-- Users Table -->
                    <div class="data-table-container">
                        <table class="data-table" id="usersTable">
                            <thead>
                                <tr>
                                    <th class="checkbox-col">
                                        <input type="checkbox" id="selectAllUsers">
                                    </th>
                                    <th>User</th>
                                    <th>Email</th>
                                    <th>Role</th>
                                    <th>Status</th>
                                    <th>Joined</th>
                                    <th>Last Active</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="usersTableBody">
                                <!-- Users will be loaded here -->
                            </tbody>
                        </table>
                        <div class="table-pagination">
                            <div class="pagination-info">
                                Showing <span id="userStart">0</span> to <span id="userEnd">0</span> of <span id="userTotal">0</span> users
                            </div>
                            <div class="pagination-controls">
                                <button class="pagination-btn" id="userPrevPage" disabled>
                                    <span class="material-icons">chevron_left</span>
                                </button>
                                <span class="pagination-current" id="userCurrentPage">1</span>
                                <button class="pagination-btn" id="userNextPage">
                                    <span class="material-icons">chevron_right</span>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Other views will be added here -->
            </main>
        </div>
    </div>

    <!-- Access Denied Screen -->
    <div id="accessDenied" class="access-denied" style="display: none;">
        <div class="denied-content">
            <span class="material-icons denied-icon">lock</span>
            <h1>Access Denied</h1>
            <p>You don't have permission to access the admin dashboard.</p>
            <a href="/app/" class="btn btn-primary">Return to App</a>
        </div>
    </div>

    <!-- JavaScript -->
    <script src="/app/js/firebase-config.js"></script>
    <script src="/app/admin/js/core/auth-guard.js"></script>
    <script src="/app/admin/js/core/router.js"></script>
    <script src="/app/admin/js/core/api-client.js"></script>
    <script src="/app/admin/js/modules/dashboard.js"></script>
    <script src="/app/admin/js/modules/users.js"></script>
    <script src="/app/admin/js/admin-app.js"></script>
</body>
</html>